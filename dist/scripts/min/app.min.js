angular.module("blocJams",["ui.router"]).config(function(a,b,c){c.html5Mode({enabled:!0,requireBase:!1}),b.otherwise("/landing"),a.state("landing",{url:"/landing",controller:"Landing.controller",templateUrl:"/templates/landing.html"}).state("album",{url:"/album",controller:"Album.controller",templateUrl:"/templates/album.html"}).state("collection",{url:"/collection",controller:"Collection.controller",templateUrl:"/templates/collection.html"})}).controller("Landing.controller",["$scope","$rootScope",function(a,b){a.landingTitle="Turn the music up!",b.bodyClass="landing";var c=document.getElementsByClassName("point"),d=function(){for(var a=0;3>a;a++)c[a].style.opacity=1,c[a].style.transform="scaleX(1) translateY(0)",c[a].style.msTransform="scaleX(1) translateY(0)",c[a].style.WebkitTransform="scaleX(1) translateY(0)"};d()}]).controller("Album.controller",["$scope","$rootScope","MusicPlayer",function(a,b,c){a.album=albumPicasso,c.setCurrentAlbum(albumPicasso),b.bodyClass="album",a.playingTrackIndex=c.currentSongIndex(),a.togglePlay=null===a.playingTrackIndex||c.isPaused(),a.volume=80,a.$watch("volume",function(){c.setVolume(a.volume)}),a.$watch("trackProgress",function(){void 0!==a.trackProgress&&Math.abs(c.getTime()/c.getDuration()*100-a.trackProgress)>1&&c.setTime(a.trackProgress/100*c.getDuration())}),window.skope=a,a.updateSeekBarWhileSongPlays=function(){a.trackProgress=c.getTime()/c.getDuration()*100,c.getTime()===c.getDuration()&&a.nextSong()},a.listener=function(){c.registerProgressListener(function(){a.$digest(),a.$apply(function(){a.updateTime(),a.updateDuration(),a.updateSeekBarWhileSongPlays()})})},a.listener(),a.updateDuration=function(){null!==a.playingTrackIndex&&(a.duration=c.getDuration())},a.updateTime=function(){null!==a.playingTrackIndex&&(a.time=c.getTime())},a.infoShow=function(){return null!==a.playingTrackIndex},a.togglePlayPause=function(){a.togglePlay=c.togglePlayFromPlayerBar(),null===a.playingTrackIndex&&(a.playingTrackIndex=0),(!a.togglePlay||a.togglePlay&&null===a.playingTrackIndex)&&a.listener()},a.enterHover=function(b){a.hoveredIndex=b},a.leaveHover=function(b){a.hoveredIndex=null},a.hideTrack=function(b){return a.hoveredIndex===b||a.playingTrackIndex===b},a.isPaused=function(){return c.isPaused()},a.pauseSong=function(b){c.pause(),a.playingTrackIndex=b,a.togglePlay=!0},a.playSong=function(b){a.playingTrackIndex!==b&&c.setSong(b+1),a.playingTrackIndex=b,c.play(),a.listener(),a.togglePlay=!1},a.nextSong=function(){c.nextSong(),a.playingTrackIndex++,a.playingTrackIndex>=a.album.songs.length&&(a.playingTrackIndex=0),a.listener(),a.togglePlay=!1},a.previousSong=function(){c.previousSong(),a.playingTrackIndex--,a.playingTrackIndex<0&&(a.playingTrackIndex=a.album.songs.length-1),a.listener(),a.togglePlay=!1},null!==a.playingTrackIndex&&(a.updateTime(),a.updateDuration(),a.updateSeekBarWhileSongPlays())}]).controller("Collection.controller",["$scope","$rootScope",function(a,b){a.albums=[albumPicasso],b.bodyClass="collection"}]).factory("MusicPlayer",function(){var a=null,b=null,c=null,d=null,e=80,f=function(a,b){return a.songs.indexOf(b)};return{setCurrentAlbum:function(b){for(a=b,i=0;i<b.songs.length;i++){var c=new buzz.sound(b.songs[i].audioUrl,{formats:["mp3"],preload:"metadata"}),d=function(a,b){return function(){b.getDuration()}};c.bind("loadedmetadata",d(i,c))}},setSong:function(f){d&&(d.stop(),d.unbind("timeupdate")),b=f,c=a.songs[f-1],d=new buzz.sound(c.audioUrl,{formats:["mp3"],preload:!0}),this.setVolume(e)},setVolume:function(a){e=a,d&&d.setVolume(a)},setTime:function(a){d&&d.setTime(a)},togglePlayFromPlayerBar:function(){return null===b?this.nextSong():d.isPaused()?(d.play(),!1):d?(d.pause(),!0):void 0},isPaused:function(){return d.isPaused()},getTime:function(){return d.getTime()},registerProgressListener:function(a){null!==d&&d.bind("timeupdate",a)},getDuration:function(){return d.getDuration()},pause:function(){d.pause()},play:function(){d.play()},currentSongIndex:function(){return d?f(a,c):null},nextSong:function(){var b=f(a,c);b++,b>=a.songs.length&&(b=0),this.setSong(b+1),d.play()},previousSong:function(){var b=f(a,c);b--,0>b&&(b=a.songs.length-1),this.setSong(b+1),d.play()}}}).directive("mySlider",["MusicPlayer","$document",function(a,b){return{templateUrl:"templates/slider.html",restrict:"E",replace:!0,scope:{value:"="},link:function(a,c,d){function e(b){var d=b.pageX-(c[0].getBoundingClientRect().left+document.body.scrollLeft),e=c[0].offsetWidth,f=d/e;a.value=100*f,a.setBarLimits(),a.$apply()}function f(){b.unbind("mousemove",e),b.unbind("mouseup",f)}a.fillStyles={width:(a.value||0)+"%"},a.thumbStyles={left:a.fillStyles.width},a.$watch("value",function(){a.fillStyles={width:(a.value||0)+"%"},a.thumbStyles={left:a.fillStyles.width}}),a.setBarLimits=function(){a.value<=0?a.value=0:a.value>=100&&(a.value=100)},c.on("mousedown",function(d){if(void 0!==a.value){var g=d.pageX-(c[0].getBoundingClientRect().left+document.body.scrollLeft),h=c[0].offsetWidth,i=g/h;a.value=100*i,b.on("mousemove",e),b.on("mouseup",f),a.setBarLimits()}})}}}]).filter("filterTime",function(){return function(a){var b=parseFloat(a);if(isNaN(b))return"0:00";var c=Math.floor(b/60),d=Math.floor(b-60*c);if(d>=10)var e=c+":"+d;else var e=c+":0"+d;return e}});